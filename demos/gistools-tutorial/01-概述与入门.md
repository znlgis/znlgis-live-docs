# GIS数据处理教程概述

## 前言

地理信息系统（GIS）数据处理是空间分析的基础。本教程以数据为核心，介绍如何使用Java进行GIS数据的读取、转换、分析和存储，重点体现处理GIS问题的思路和方法。

## 核心概念

### 1. 几何数据的本质

在GIS中，所有空间要素都可以抽象为几何对象。几何对象的基础是**坐标点**，通过坐标点的不同组合方式，构成了点、线、面等各种几何类型：

| 几何类型 | 说明 | 维度 |
|---------|------|------|
| Point | 单个坐标点 | 0 |
| LineString | 由多个点组成的线段序列 | 1 |
| Polygon | 由闭合环组成的多边形 | 2 |
| MultiPoint | 多点集合 | 0 |
| MultiLineString | 多线集合 | 1 |
| MultiPolygon | 多面集合 | 2 |
| GeometryCollection | 几何对象集合 | 混合 |

### 2. 数据格式

GIS数据有多种存储和交换格式，常见的包括：

- **WKT（Well-Known Text）**：文本格式，易读易写
- **GeoJSON**：基于JSON的地理数据格式，Web开发常用
- **Shapefile**：ESRI定义的矢量数据格式，行业标准
- **FileGDB**：ESRI文件地理数据库
- **PostGIS**：PostgreSQL的空间扩展，企业级存储方案
- **国土TXT**：国内自然资源部门使用的文本格式

### 3. 坐标参考系统

坐标参考系统（CRS）定义了如何将地球表面的位置映射到二维平面。理解坐标系是正确处理GIS数据的前提：

- **地理坐标系**：使用经纬度表示位置（如CGCS2000，EPSG:4490）
- **投影坐标系**：将地球表面投影到平面，使用米为单位（如CGCS2000 3度带投影）

## 数据处理思路

处理GIS数据通常遵循以下流程：

```
数据输入 → 坐标系检查/转换 → 数据处理/分析 → 结果输出
```

### 典型场景

1. **数据格式转换**：将Shapefile转换为GeoJSON供Web展示
2. **坐标系统一**：将不同坐标系的数据统一到同一坐标系
3. **空间分析**：计算面积、长度、缓冲区、相交等
4. **数据入库**：将矢量数据导入PostGIS数据库

## 技术栈选择

### JTS Topology Suite

JTS是Java平台上最成熟的几何处理库，提供了完整的几何对象模型和空间操作算法：

```java
// 创建几何对象
GeometryFactory factory = new GeometryFactory();
Point point = factory.createPoint(new Coordinate(116.397, 39.908));

// 空间操作
Geometry buffer = point.buffer(0.01);
boolean intersects = geomA.intersects(geomB);
```

### GeoTools

GeoTools是开源的Java GIS工具包，提供了丰富的数据读写和坐标转换功能：

```java
// 读取Shapefile
File file = new File("data.shp");
ShapefileDataStore store = new ShapefileDataStore(file.toURI().toURL());
SimpleFeatureSource source = store.getFeatureSource();

// 坐标转换
CoordinateReferenceSystem sourceCRS = CRS.decode("EPSG:4490");
CoordinateReferenceSystem targetCRS = CRS.decode("EPSG:4526");
MathTransform transform = CRS.findMathTransform(sourceCRS, targetCRS);
Geometry transformed = JTS.transform(geometry, transform);
```

### GDAL/OGR

GDAL是最强大的地理数据抽象库，支持几乎所有GIS数据格式：

```java
// 注册驱动
ogr.RegisterAll();

// 打开数据源
DataSource dataSource = ogr.Open("data.gdb");
Layer layer = dataSource.GetLayer(0);
```

## 数据模型设计

在处理GIS数据时，统一的数据模型可以简化不同格式间的转换：

```
WktLayer（图层）
├── 图层名称（ywName/zwName）
├── 坐标参考（wkid）
├── 几何类型（geometryType）
├── 容差（tolerance）
├── 字段定义（fields）
│   ├── 字段名（ywName/zwName）
│   └── 数据类型（dataType）
└── 要素集合（features）
    ├── 要素ID（wfId）
    ├── 几何数据（wkt）
    └── 属性值（fieldValues）
```

这种中间数据模型的设计思路是：
- 使用WKT作为几何数据的统一表示
- 保持字段定义与数据分离
- 支持不同格式间的无损转换

## 教程目录

本教程包含以下内容：

1. [几何数据基础](./02-几何数据基础.md) - 点、线、面的创建和基本操作
2. [坐标系统详解](./03-坐标系统详解.md) - 坐标系的理解和转换
3. [空间关系分析](./04-空间关系分析.md) - 相交、包含等空间关系判断
4. [空间计算操作](./05-空间计算操作.md) - 缓冲区、裁剪、合并等操作
5. [Shapefile处理](./06-Shapefile处理.md) - Shapefile的读写和转换
6. [GeoJSON处理](./07-GeoJSON处理.md) - GeoJSON格式的处理
7. [PostGIS数据库](./08-PostGIS数据库.md) - 空间数据库的交互
8. [国土TXT格式](./09-国土TXT格式.md) - 国土资源部门数据处理
9. [数据格式转换](./10-数据格式转换.md) - 不同格式间的转换

## 学习建议

1. **理解数据结构**：先理解几何对象的数据结构，再学习操作方法
2. **注意坐标系**：处理数据前务必确认坐标系，避免坐标混乱
3. **选择合适工具**：根据数据格式和处理需求选择合适的工具库
4. **关注性能**：大数据量处理时注意内存管理和算法效率

## 开发环境

推荐的开发环境配置：

```xml
<!-- Maven依赖 -->
<dependency>
    <groupId>org.locationtech.jts</groupId>
    <artifactId>jts-core</artifactId>
    <version>1.20.0</version>
</dependency>
<dependency>
    <groupId>org.geotools</groupId>
    <artifactId>gt-main</artifactId>
    <version>28.5</version>
</dependency>
<dependency>
    <groupId>org.geotools</groupId>
    <artifactId>gt-shapefile</artifactId>
    <version>28.5</version>
</dependency>
<dependency>
    <groupId>org.geotools</groupId>
    <artifactId>gt-geojson</artifactId>
    <version>28.5</version>
</dependency>
```
