# ç¬¬åç« ï¼šæœ€ä½³å®è·µä¸å¸¸è§é—®é¢˜è§£ç­”

## ç›®å½•

1. [ç¼–ç è§„èŒƒä¸æœ€ä½³å®è·µ](#1-ç¼–ç è§„èŒƒä¸æœ€ä½³å®è·µ)
2. [æ€§èƒ½ä¼˜åŒ–æŒ‡å—](#2-æ€§èƒ½ä¼˜åŒ–æŒ‡å—)
3. [å®‰å…¨åŠ å›ºæªæ–½](#3-å®‰å…¨åŠ å›ºæªæ–½)
4. [æ•°æ®åº“ä¼˜åŒ–](#4-æ•°æ®åº“ä¼˜åŒ–)
5. [å¸¸è§é—®é¢˜è§£ç­”](#5-å¸¸è§é—®é¢˜è§£ç­”)
6. [æ•…éšœæ’æŸ¥æŒ‡å—](#6-æ•…éšœæ’æŸ¥æŒ‡å—)
7. [ç‰ˆæœ¬å‡çº§æŒ‡å—](#7-ç‰ˆæœ¬å‡çº§æŒ‡å—)
8. [å­¦ä¹ èµ„æºä¸ç¤¾åŒºæ”¯æŒ](#8-å­¦ä¹ èµ„æºä¸ç¤¾åŒºæ”¯æŒ)

---

## 1. ç¼–ç è§„èŒƒä¸æœ€ä½³å®è·µ

### 1.1 åç«¯ç¼–ç è§„èŒƒ

**å‘½åè§„èŒƒ**ï¼š

```csharp
// âœ… æ­£ç¡®ç¤ºä¾‹

// ç±»åï¼šPascalCase
public class SysUserService { }
public class OrderDetailDto { }

// æ¥å£åï¼šI + PascalCase
public interface IUserService { }
public interface IEmailSender { }

// æ–¹æ³•åï¼šPascalCase
public async Task<List<User>> GetUserListAsync() { }
public void ProcessOrder() { }

// å˜é‡åï¼šcamelCase
private readonly ISqlSugarClient _db;
private string userName;
private int orderCount;

// å¸¸é‡ï¼šUPPER_SNAKE_CASE æˆ– PascalCase
public const string CACHE_KEY_PREFIX = "user:";
public const int MaxRetryCount = 3;

// å¼‚æ­¥æ–¹æ³•ï¼šä»¥Asyncç»“å°¾
public async Task<User> GetUserByIdAsync(long id) { }
```

**ä»£ç ç»“æ„è§„èŒƒ**ï¼š

```csharp
/// <summary>
/// ç”¨æˆ·æœåŠ¡
/// </summary>
[ApiDescriptionSettings(Order = 100)]
public class SysUserService : IDynamicApiController, ITransient
{
    #region ä¾èµ–æ³¨å…¥
    
    private readonly SqlSugarRepository<SysUser> _userRep;
    private readonly SysCacheService _cache;
    private readonly ILogger<SysUserService> _logger;

    public SysUserService(
        SqlSugarRepository<SysUser> userRep,
        SysCacheService cache,
        ILogger<SysUserService> logger)
    {
        _userRep = userRep;
        _cache = cache;
        _logger = logger;
    }
    
    #endregion

    #region æŸ¥è¯¢æ–¹æ³•

    /// <summary>
    /// è·å–ç”¨æˆ·åˆ†é¡µåˆ—è¡¨
    /// </summary>
    /// <param name="input">æŸ¥è¯¢å‚æ•°</param>
    /// <returns>åˆ†é¡µç»“æœ</returns>
    [DisplayName("è·å–ç”¨æˆ·åˆ†é¡µåˆ—è¡¨")]
    public async Task<SqlSugarPagedList<UserOutput>> Page(PageUserInput input)
    {
        // 1. å‚æ•°éªŒè¯
        if (input == null)
            throw Oops.Oh("å‚æ•°ä¸èƒ½ä¸ºç©º");

        // 2. æ„å»ºæŸ¥è¯¢
        var query = _userRep.AsQueryable()
            .WhereIF(!string.IsNullOrWhiteSpace(input.Account), u => u.Account.Contains(input.Account))
            .WhereIF(!string.IsNullOrWhiteSpace(input.RealName), u => u.RealName.Contains(input.RealName));

        // 3. æ‰§è¡ŒæŸ¥è¯¢
        return await query
            .OrderBy(u => u.OrderNo)
            .Select<UserOutput>()
            .ToPagedListAsync(input.Page, input.PageSize);
    }

    #endregion

    #region æ–°å¢/ç¼–è¾‘æ–¹æ³•

    /// <summary>
    /// æ–°å¢ç”¨æˆ·
    /// </summary>
    [ApiDescriptionSettings(Name = "Add"), HttpPost]
    [DisplayName("æ–°å¢ç”¨æˆ·")]
    public async Task<long> Add(AddUserInput input)
    {
        // 1. ä¸šåŠ¡éªŒè¯
        await ValidateUserInput(input);

        // 2. æ•°æ®è½¬æ¢
        var user = input.Adapt<SysUser>();
        user.Password = CryptogramUtil.Encrypt(input.Password);

        // 3. ä¿å­˜æ•°æ®
        await _userRep.InsertAsync(user);

        // 4. è®°å½•æ—¥å¿—
        _logger.LogInformation($"æ–°å¢ç”¨æˆ·æˆåŠŸï¼š{user.Account}");

        return user.Id;
    }

    #endregion

    #region ç§æœ‰æ–¹æ³•

    private async Task ValidateUserInput(AddUserInput input)
    {
        // éªŒè¯è´¦å·å”¯ä¸€
        var exist = await _userRep.IsAnyAsync(u => u.Account == input.Account);
        if (exist)
            throw Oops.Oh(ErrorCodeEnum.D1003);

        // éªŒè¯æ‰‹æœºå·å”¯ä¸€
        if (!string.IsNullOrEmpty(input.Phone))
        {
            exist = await _userRep.IsAnyAsync(u => u.Phone == input.Phone);
            if (exist)
                throw Oops.Oh("æ‰‹æœºå·å·²å­˜åœ¨");
        }
    }

    #endregion
}
```

### 1.2 å‰ç«¯ç¼–ç è§„èŒƒ

**Vueç»„ä»¶è§„èŒƒ**ï¼š

```vue
<!-- âœ… æ­£ç¡®ç¤ºä¾‹ -->
<template>
  <div class="user-list">
    <!-- ç»„ä»¶ç»“æ„æ¸…æ™° -->
    <SearchForm v-model="queryParams" @search="handleSearch" />
    
    <DataTable
      :data="tableData"
      :loading="loading"
      @edit="handleEdit"
      @delete="handleDelete"
    />
    
    <Pagination
      v-model:page="queryParams.page"
      v-model:page-size="queryParams.pageSize"
      :total="total"
      @change="getList"
    />
    
    <!-- å¯¹è¯æ¡†æ”¾åœ¨æœ€å -->
    <UserForm v-model="formVisible" :data="currentRow" @success="getList" />
  </div>
</template>

<script setup lang="ts">
// 1. å¯¼å…¥å£°æ˜
import { ref, reactive, onMounted } from 'vue'
import { userApi } from '@/api/system/user'
import type { UserInfo, UserQuery } from '@/api/model/user'
import { ElMessage } from 'element-plus'

// 2. ç»„ä»¶å£°æ˜
import SearchForm from './components/SearchForm.vue'
import DataTable from './components/DataTable.vue'
import UserForm from './components/UserForm.vue'

// 3. Props/Emitså®šä¹‰
const props = defineProps<{
  orgId?: number
}>()

// 4. å“åº”å¼æ•°æ®
const loading = ref(false)
const tableData = ref<UserInfo[]>([])
const total = ref(0)
const formVisible = ref(false)
const currentRow = ref<UserInfo | null>(null)

const queryParams = reactive<UserQuery>({
  account: '',
  realName: '',
  page: 1,
  pageSize: 10
})

// 5. è®¡ç®—å±æ€§
// ...

// 6. æ–¹æ³•å®šä¹‰
const getList = async () => {
  loading.value = true
  try {
    const res = await userApi.getPage(queryParams)
    tableData.value = res.data.items
    total.value = res.data.total
  } catch (error) {
    console.error('è·å–åˆ—è¡¨å¤±è´¥:', error)
  } finally {
    loading.value = false
  }
}

const handleSearch = () => {
  queryParams.page = 1
  getList()
}

const handleEdit = (row: UserInfo) => {
  currentRow.value = row
  formVisible.value = true
}

const handleDelete = async (row: UserInfo) => {
  try {
    await userApi.delete(row.id)
    ElMessage.success('åˆ é™¤æˆåŠŸ')
    getList()
  } catch (error) {
    console.error('åˆ é™¤å¤±è´¥:', error)
  }
}

// 7. ç”Ÿå‘½å‘¨æœŸ
onMounted(() => {
  getList()
})
</script>

<style scoped lang="scss">
.user-list {
  padding: 16px;
  
  :deep(.el-table) {
    margin-top: 16px;
  }
}
</style>
```

### 1.3 Gitæäº¤è§„èŒƒ

```bash
# æäº¤æ ¼å¼
<type>(<scope>): <subject>

# typeç±»å‹
# feat: æ–°åŠŸèƒ½
# fix: ä¿®å¤bug
# docs: æ–‡æ¡£æ›´æ–°
# style: ä»£ç æ ¼å¼
# refactor: é‡æ„
# test: æµ‹è¯•
# chore: æ„å»º/å·¥å…·

# ç¤ºä¾‹
git commit -m "feat(user): æ–°å¢ç”¨æˆ·å¯¼å…¥åŠŸèƒ½"
git commit -m "fix(order): ä¿®å¤è®¢å•é‡‘é¢è®¡ç®—é”™è¯¯"
git commit -m "docs(readme): æ›´æ–°éƒ¨ç½²æ–‡æ¡£"
git commit -m "refactor(auth): ä¼˜åŒ–ç™»å½•éªŒè¯é€»è¾‘"
```

---

## 2. æ€§èƒ½ä¼˜åŒ–æŒ‡å—

### 2.1 åç«¯æ€§èƒ½ä¼˜åŒ–

**æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ–**ï¼š

```csharp
// âŒ é”™è¯¯ç¤ºä¾‹ï¼šN+1æŸ¥è¯¢é—®é¢˜
var users = await _userRep.GetListAsync();
foreach (var user in users)
{
    user.Roles = await _roleRep.GetByUserIdAsync(user.Id); // æ¯æ¬¡å¾ªç¯éƒ½æŸ¥è¯¢
}

// âœ… æ­£ç¡®ç¤ºä¾‹ï¼šä½¿ç”¨å¯¼èˆªå±æ€§ä¸€æ¬¡æ€§åŠ è½½
var users = await _userRep.AsQueryable()
    .Includes(u => u.Roles)
    .ToListAsync();

// âœ… æ­£ç¡®ç¤ºä¾‹ï¼šåªæŸ¥è¯¢éœ€è¦çš„åˆ—
var users = await _userRep.AsQueryable()
    .Select(u => new UserSimpleDto
    {
        Id = u.Id,
        Account = u.Account,
        RealName = u.RealName
    })
    .ToListAsync();

// âœ… æ­£ç¡®ç¤ºä¾‹ï¼šæ‰¹é‡æŸ¥è¯¢
var roleIds = users.Select(u => u.Id).ToList();
var roles = await _roleRep.AsQueryable()
    .Where(r => roleIds.Contains(r.UserId))
    .ToListAsync();
```

**ç¼“å­˜ä½¿ç”¨**ï¼š

```csharp
// åˆç†ä½¿ç”¨ç¼“å­˜
public async Task<UserInfo> GetUserInfo(long userId)
{
    var cacheKey = $"user:info:{userId}";
    
    // å…ˆæŸ¥ç¼“å­˜
    var user = _cache.Get<UserInfo>(cacheKey);
    if (user != null)
        return user;
    
    // ç¼“å­˜ä¸å­˜åœ¨ï¼ŒæŸ¥æ•°æ®åº“
    user = await _userRep.AsQueryable()
        .Includes(u => u.Roles)
        .FirstAsync(u => u.Id == userId);
    
    // å†™å…¥ç¼“å­˜ï¼ˆè®¾ç½®åˆç†çš„è¿‡æœŸæ—¶é—´ï¼‰
    if (user != null)
        _cache.Set(cacheKey, user, TimeSpan.FromMinutes(30));
    
    return user;
}

// æ•°æ®å˜æ›´æ—¶æ¸…é™¤ç¼“å­˜
public async Task UpdateUser(UpdateUserInput input)
{
    await _userRep.UpdateAsync(input.Adapt<SysUser>());
    
    // æ¸…é™¤ç›¸å…³ç¼“å­˜
    _cache.Remove($"user:info:{input.Id}");
    _cache.RemoveByPrefix("user:list");
}
```

**å¼‚æ­¥ç¼–ç¨‹**ï¼š

```csharp
// âœ… æ­£ç¡®ä½¿ç”¨å¼‚æ­¥
public async Task<OrderOutput> ProcessOrder(long orderId)
{
    // å¹¶è¡Œæ‰§è¡Œç‹¬ç«‹ä»»åŠ¡
    var orderTask = _orderRep.GetByIdAsync(orderId);
    var itemsTask = _itemRep.GetListAsync(i => i.OrderId == orderId);
    var logTask = RecordOperationLog(orderId, "æŸ¥çœ‹è®¢å•");
    
    await Task.WhenAll(orderTask, itemsTask, logTask);
    
    var order = await orderTask;
    var items = await itemsTask;
    
    return new OrderOutput
    {
        Order = order,
        Items = items
    };
}

// âŒ é¿å…åœ¨å¾ªç¯ä¸­ä½¿ç”¨å¼‚æ­¥
foreach (var item in items)
{
    await ProcessItem(item); // ä¸²è¡Œæ‰§è¡Œï¼Œæ•ˆç‡ä½
}

// âœ… ä½¿ç”¨å¹¶è¡Œå¤„ç†
await Parallel.ForEachAsync(items, async (item, ct) =>
{
    await ProcessItem(item);
});
```

### 2.2 å‰ç«¯æ€§èƒ½ä¼˜åŒ–

**ç»„ä»¶æ‡’åŠ è½½**ï¼š

```typescript
// è·¯ç”±æ‡’åŠ è½½
const routes = [
  {
    path: '/user',
    component: () => import('@/views/user/index.vue')
  }
]

// ç»„ä»¶å¼‚æ­¥åŠ è½½
const HeavyComponent = defineAsyncComponent(() =>
  import('./HeavyComponent.vue')
)
```

**è™šæ‹Ÿæ»šåŠ¨**ï¼š

```vue
<!-- å¤§åˆ—è¡¨ä½¿ç”¨è™šæ‹Ÿæ»šåŠ¨ -->
<template>
  <el-table-v2
    :columns="columns"
    :data="tableData"
    :width="700"
    :height="400"
    fixed
  />
</template>
```

**é˜²æŠ–èŠ‚æµ**ï¼š

```typescript
import { debounce, throttle } from 'lodash-es'

// æœç´¢è¾“å…¥é˜²æŠ–
const handleSearch = debounce(async (keyword: string) => {
  await searchApi(keyword)
}, 300)

// æ»šåŠ¨äº‹ä»¶èŠ‚æµ
const handleScroll = throttle(() => {
  // å¤„ç†æ»šåŠ¨
}, 100)
```

---

## 3. å®‰å…¨åŠ å›ºæªæ–½

### 3.1 è®¤è¯æˆæƒå®‰å…¨

```csharp
// Tokenå®‰å…¨é…ç½®
services.AddJwt<JwtHandler>(options =>
{
    options.ExpiredTime = 120; // 2å°æ—¶è¿‡æœŸ
    options.ClockSkew = 10; // æ—¶é’Ÿåç§»
});

// å¯†ç åŠ å¯†
public static class PasswordHelper
{
    public static string HashPassword(string password)
    {
        // ä½¿ç”¨BCryptåŠ å¯†
        return BCrypt.Net.BCrypt.HashPassword(password, 12);
    }

    public static bool VerifyPassword(string password, string hash)
    {
        return BCrypt.Net.BCrypt.Verify(password, hash);
    }
}

// ç™»å½•å®‰å…¨æ§åˆ¶
public async Task<LoginOutput> Login(LoginInput input)
{
    // éªŒè¯ç æ ¡éªŒ
    if (!await ValidateCaptcha(input.CaptchaId, input.CaptchaCode))
        throw Oops.Oh("éªŒè¯ç é”™è¯¯");

    // è´¦å·é”å®šæ£€æŸ¥
    var lockKey = $"login:lock:{input.Account}";
    if (_cache.Exists(lockKey))
        throw Oops.Oh("è´¦å·å·²é”å®šï¼Œè¯·15åˆ†é’Ÿåé‡è¯•");

    // å¯†ç é”™è¯¯æ¬¡æ•°æ£€æŸ¥
    var failKey = $"login:fail:{input.Account}";
    var failCount = _cache.Get<int>(failKey);
    if (failCount >= 5)
    {
        _cache.Set(lockKey, 1, TimeSpan.FromMinutes(15));
        throw Oops.Oh("å¯†ç é”™è¯¯æ¬¡æ•°è¿‡å¤šï¼Œè´¦å·å·²é”å®š");
    }

    // éªŒè¯å¯†ç 
    var user = await _userRep.GetFirstAsync(u => u.Account == input.Account);
    if (user == null || !PasswordHelper.VerifyPassword(input.Password, user.Password))
    {
        _cache.Set(failKey, failCount + 1, TimeSpan.FromMinutes(30));
        throw Oops.Oh($"è´¦å·æˆ–å¯†ç é”™è¯¯ï¼Œè¿˜å‰©{4 - failCount}æ¬¡æœºä¼š");
    }

    // ç™»å½•æˆåŠŸï¼Œæ¸…é™¤å¤±è´¥æ¬¡æ•°
    _cache.Remove(failKey);
    
    // ç”ŸæˆToken...
}
```

### 3.2 SQLæ³¨å…¥é˜²æŠ¤

```csharp
// âœ… ä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢
var users = await _db.Queryable<SysUser>()
    .Where(u => u.Account == input.Account) // SqlSugarè‡ªåŠ¨å‚æ•°åŒ–
    .ToListAsync();

// âœ… ä½¿ç”¨åŸç”ŸSQLæ—¶ä¹Ÿè¦å‚æ•°åŒ–
var sql = "SELECT * FROM sys_user WHERE account = @account";
var users = await _db.Ado.SqlQueryAsync<SysUser>(sql, new { account = input.Account });

// âŒ ç¦æ­¢å­—ç¬¦ä¸²æ‹¼æ¥
var sql = $"SELECT * FROM sys_user WHERE account = '{input.Account}'"; // å±é™©ï¼
```

### 3.3 XSSé˜²æŠ¤

```csharp
// è¾“å‡ºç¼–ç 
public string SanitizeHtml(string input)
{
    return System.Web.HttpUtility.HtmlEncode(input);
}

// å¯Œæ–‡æœ¬è¿‡æ»¤
public string FilterRichText(string html)
{
    var sanitizer = new HtmlSanitizer();
    sanitizer.AllowedTags.Add("p");
    sanitizer.AllowedTags.Add("br");
    sanitizer.AllowedTags.Add("b");
    sanitizer.AllowedTags.Add("i");
    sanitizer.AllowedTags.Add("u");
    return sanitizer.Sanitize(html);
}
```

### 3.4 æ•æ„Ÿæ•°æ®ä¿æŠ¤

```csharp
// æ•æ„Ÿå­—æ®µè„±æ•
public class UserOutput
{
    public string Account { get; set; }
    
    [SensitiveData(SensitiveType.Phone)]
    public string Phone { get; set; }
    
    [SensitiveData(SensitiveType.IdCard)]
    public string IdCard { get; set; }
    
    [SensitiveData(SensitiveType.Email)]
    public string Email { get; set; }
}

// è„±æ•å¤„ç†
public static class DataMaskHelper
{
    public static string MaskPhone(string phone)
    {
        if (string.IsNullOrEmpty(phone) || phone.Length != 11)
            return phone;
        return phone.Substring(0, 3) + "****" + phone.Substring(7);
    }

    public static string MaskIdCard(string idCard)
    {
        if (string.IsNullOrEmpty(idCard) || idCard.Length < 8)
            return idCard;
        return idCard.Substring(0, 4) + "**********" + idCard.Substring(idCard.Length - 4);
    }

    public static string MaskEmail(string email)
    {
        if (string.IsNullOrEmpty(email) || !email.Contains("@"))
            return email;
        var parts = email.Split('@');
        var name = parts[0];
        var masked = name.Length > 2 
            ? name.Substring(0, 2) + "***" 
            : "***";
        return masked + "@" + parts[1];
    }
}
```

---

## 4. æ•°æ®åº“ä¼˜åŒ–

### 4.1 ç´¢å¼•ä¼˜åŒ–

```sql
-- ä¸ºå¸¸ç”¨æŸ¥è¯¢å­—æ®µæ·»åŠ ç´¢å¼•
CREATE INDEX idx_user_account ON sys_user(account);
CREATE INDEX idx_user_phone ON sys_user(phone);
CREATE INDEX idx_user_org_id ON sys_user(org_id);
CREATE INDEX idx_user_status_create_time ON sys_user(status, create_time);

-- å¤åˆç´¢å¼•ï¼ˆæ³¨æ„å­—æ®µé¡ºåºï¼‰
CREATE INDEX idx_order_customer_status_time ON order(customer_id, status, create_time);

-- æŸ¥çœ‹ç´¢å¼•ä½¿ç”¨æƒ…å†µ
SHOW INDEX FROM sys_user;

-- åˆ†ææŸ¥è¯¢è®¡åˆ’
EXPLAIN SELECT * FROM sys_user WHERE account = 'admin';
```

### 4.2 åˆ†è¡¨ç­–ç•¥

```csharp
// æŒ‰æœˆä»½åˆ†è¡¨
[SplitTable(SplitType.Month)]
[SugarTable("sys_log_op_{year}{month}{day}")]
public class SysLogOp : EntityBase
{
    [SugarColumn(IsPrimaryKey = true)]
    public long Id { get; set; }

    [SplitField]
    public DateTime CreateTime { get; set; }
    
    // å…¶ä»–å­—æ®µ...
}

// æŸ¥è¯¢æ—¶è‡ªåŠ¨è·¯ç”±åˆ°å¯¹åº”è¡¨
var logs = await _db.Queryable<SysLogOp>()
    .SplitTable(DateTime.Now.AddMonths(-1), DateTime.Now) // æŸ¥è¯¢æœ€è¿‘ä¸€ä¸ªæœˆ
    .ToListAsync();

// æ’å…¥æ—¶è‡ªåŠ¨è·¯ç”±
await _db.Insertable(new SysLogOp 
{ 
    CreateTime = DateTime.Now 
}).SplitTable().ExecuteCommandAsync();
```

### 4.3 è¯»å†™åˆ†ç¦»

```csharp
// é…ç½®ä¸»ä»æ•°æ®åº“
{
  "DbSettings": {
    "DbConfigs": [
      {
        "ConfigId": "master",
        "ConnectionString": "ä¸»åº“è¿æ¥",
        "SlaveConnectionConfigs": [
          {
            "HitRate": 10,
            "ConnectionString": "ä»åº“1è¿æ¥"
          },
          {
            "HitRate": 10,
            "ConnectionString": "ä»åº“2è¿æ¥"
          }
        ]
      }
    ]
  }
}

// å¼ºåˆ¶è¯»ä¸»åº“ï¼ˆç”¨äºåˆšå†™å…¥åç«‹å³è¯»å–çš„åœºæ™¯ï¼‰
var order = await _db.Queryable<Order>()
    .Master() // å¼ºåˆ¶èµ°ä¸»åº“
    .FirstAsync(o => o.Id == orderId);
```

---

## 5. å¸¸è§é—®é¢˜è§£ç­”

### 5.1 é¡¹ç›®è¿è¡Œé—®é¢˜

**Q1ï¼šè¿è¡Œæ—¶æç¤ºæ‰¾ä¸åˆ°Admin.NET.Web.Entry.dllï¼Ÿ**

Aï¼šç¡®ä¿å·²æ­£ç¡®è®¾ç½®å¯åŠ¨é¡¹ç›®ï¼š
1. å³é”®ç‚¹å‡»`Admin.NET.Web.Entry`é¡¹ç›®
2. é€‰æ‹©"è®¾ä¸ºå¯åŠ¨é¡¹ç›®"
3. é‡æ–°ç”Ÿæˆè§£å†³æ–¹æ¡ˆ

**Q2ï¼šæ•°æ®åº“è¿æ¥å¤±è´¥ï¼Ÿ**

Aï¼šæ£€æŸ¥ä»¥ä¸‹é…ç½®ï¼š
1. ç¡®è®¤æ•°æ®åº“æœåŠ¡å·²å¯åŠ¨
2. æ£€æŸ¥è¿æ¥å­—ç¬¦ä¸²æ˜¯å¦æ­£ç¡®
3. æ£€æŸ¥ç”¨æˆ·åå¯†ç æ˜¯å¦æ­£ç¡®
4. æ£€æŸ¥é˜²ç«å¢™æ˜¯å¦å¼€æ”¾ç«¯å£
5. å¯¹äºMySQLï¼Œç¡®è®¤å·²å®‰è£…`CharSet=utf8mb4`

```json
// æ­£ç¡®çš„MySQLè¿æ¥å­—ç¬¦ä¸²
"ConnectionString": "Data Source=localhost;Database=AdminNET;User ID=root;Password=123456;pooling=true;port=3306;sslmode=none;CharSet=utf8mb4;AllowLoadLocalInfile=true"
```

**Q3ï¼šSwaggeré¡µé¢ç©ºç™½ï¼Ÿ**

Aï¼šå¯èƒ½åŸå› ï¼š
1. åç«¯æœåŠ¡æœªå®Œå…¨å¯åŠ¨
2. å­˜åœ¨æ¥å£å®šä¹‰é”™è¯¯
3. æµè§ˆå™¨ç¼“å­˜é—®é¢˜

è§£å†³æ–¹æ³•ï¼š
```bash
# æ¸…ç†å¹¶é‡æ–°ç”Ÿæˆ
dotnet clean
dotnet build
dotnet run
```

### 5.2 å‰ç«¯é—®é¢˜

**Q1ï¼špnpm installå¤±è´¥ï¼Ÿ**

Aï¼šå°è¯•ä»¥ä¸‹æ–¹æ³•ï¼š
```bash
# æ¸…é™¤ç¼“å­˜
pnpm store prune

# åˆ é™¤lockæ–‡ä»¶å’Œnode_modules
rm -rf node_modules pnpm-lock.yaml

# ä½¿ç”¨æ·˜å®é•œåƒ
pnpm config set registry https://registry.npmmirror.com

# é‡æ–°å®‰è£…
pnpm install
```

**Q2ï¼šç™»å½•åé¡µé¢ç©ºç™½ï¼Ÿ**

Aï¼šæ£€æŸ¥ä»¥ä¸‹å‡ ç‚¹ï¼š
1. æµè§ˆå™¨æ§åˆ¶å°æ˜¯å¦æœ‰é”™è¯¯
2. APIè¯·æ±‚æ˜¯å¦è¿”å›æ­£ç¡®æ•°æ®
3. ç”¨æˆ·æƒé™æ˜¯å¦é…ç½®æ­£ç¡®
4. æ¸…é™¤æµè§ˆå™¨ç¼“å­˜å’ŒlocalStorage

**Q3ï¼šæ¥å£è¯·æ±‚è·¨åŸŸï¼Ÿ**

Aï¼šç¡®è®¤ä»¥ä¸‹é…ç½®ï¼š
1. åç«¯CORSé…ç½®æ­£ç¡®
2. å‰ç«¯APIåœ°å€é…ç½®æ­£ç¡®
3. Nginxåå‘ä»£ç†é…ç½®æ­£ç¡®

```csharp
// åç«¯CORSé…ç½®
services.AddCorsAccessor(options =>
{
    options.AddPolicy("AllowAll", builder =>
    {
        builder.AllowAnyOrigin()
               .AllowAnyMethod()
               .AllowAnyHeader();
    });
});
```

### 5.3 éƒ¨ç½²é—®é¢˜

**Q1ï¼šDockerå¯åŠ¨å¤±è´¥ï¼Ÿ**

Aï¼šæ£€æŸ¥æ­¥éª¤ï¼š
```bash
# æŸ¥çœ‹å®¹å™¨æ—¥å¿—
docker logs adminnet-api

# æ£€æŸ¥ç«¯å£å ç”¨
netstat -tlnp | grep 5005

# ç¡®è®¤ç¯å¢ƒå˜é‡
docker exec adminnet-api env
```

**Q2ï¼šNginx 502é”™è¯¯ï¼Ÿ**

Aï¼šå¯èƒ½åŸå› ï¼š
1. åç«¯æœåŠ¡æœªå¯åŠ¨
2. åç«¯ç«¯å£é…ç½®é”™è¯¯
3. é˜²ç«å¢™é˜»æ­¢äº†ç«¯å£

```bash
# æ£€æŸ¥åç«¯æœåŠ¡
curl http://localhost:5005/health

# æ£€æŸ¥Nginxé…ç½®
nginx -t

# æŸ¥çœ‹Nginxé”™è¯¯æ—¥å¿—
tail -f /var/log/nginx/error.log
```

---

## 6. æ•…éšœæ’æŸ¥æŒ‡å—

### 6.1 æ—¥å¿—åˆ†æ

**åç«¯æ—¥å¿—ä½ç½®**ï¼š
- æ§åˆ¶å°è¾“å‡º
- `logs/`ç›®å½•ä¸‹çš„æ—¥å¿—æ–‡ä»¶
- Windowsäº‹ä»¶æŸ¥çœ‹å™¨ï¼ˆIISéƒ¨ç½²æ—¶ï¼‰
- systemdæ—¥å¿—ï¼ˆLinuxéƒ¨ç½²æ—¶ï¼‰

```bash
# æŸ¥çœ‹systemdæ—¥å¿—
journalctl -u adminnet -f

# æŸ¥çœ‹æœ€è¿‘100è¡Œæ—¥å¿—
journalctl -u adminnet -n 100

# æŒ‰æ—¶é—´æŸ¥çœ‹æ—¥å¿—
journalctl -u adminnet --since "2024-01-01 00:00:00"
```

### 6.2 æ€§èƒ½åˆ†æ

**ä½¿ç”¨è¯Šæ–­å·¥å…·**ï¼š

```bash
# æ”¶é›†æ€§èƒ½æ•°æ®
dotnet-trace collect -p <PID> --duration 00:00:30

# åˆ†æå†…å­˜
dotnet-dump collect -p <PID>
dotnet-dump analyze <dumpfile>

# å®æ—¶ç›‘æ§
dotnet-counters monitor -p <PID>
```

### 6.3 æ•°æ®åº“è¯Šæ–­

```sql
-- æŸ¥çœ‹æ…¢æŸ¥è¯¢
SHOW VARIABLES LIKE 'slow_query_log';
SHOW VARIABLES LIKE 'long_query_time';

-- æŸ¥çœ‹å½“å‰è¿æ¥
SHOW PROCESSLIST;

-- æŸ¥çœ‹è¡¨çŠ¶æ€
SHOW TABLE STATUS;

-- åˆ†æè¡¨
ANALYZE TABLE sys_user;

-- ä¼˜åŒ–è¡¨
OPTIMIZE TABLE sys_log_op;
```

---

## 7. ç‰ˆæœ¬å‡çº§æŒ‡å—

### 7.1 å‡çº§å‰å‡†å¤‡

1. **å¤‡ä»½æ•°æ®åº“**
```bash
mysqldump -u root -p AdminNET > backup_$(date +%Y%m%d).sql
```

2. **å¤‡ä»½ä»£ç **
```bash
git stash  # ä¿å­˜æœ¬åœ°ä¿®æ”¹
git fetch origin
```

3. **æŸ¥çœ‹æ›´æ–°æ—¥å¿—**
- è®¿é—®GitHub/GiteeæŸ¥çœ‹Release Notes
- å…³æ³¨Breaking Changes

### 7.2 å‡çº§æ­¥éª¤

```bash
# 1. æ‹‰å–æœ€æ–°ä»£ç 
git pull origin master

# 2. æ¢å¤æœ¬åœ°ä¿®æ”¹
git stash pop

# 3. è§£å†³å†²çªï¼ˆå¦‚æœæœ‰ï¼‰
git mergetool

# 4. æ›´æ–°NuGetåŒ…
dotnet restore

# 5. é‡æ–°ç¼–è¯‘
dotnet build

# 6. è¿è¡Œæ•°æ®åº“è¿ç§»ï¼ˆå¦‚éœ€è¦ï¼‰
# æŸ¥çœ‹æ˜¯å¦æœ‰æ–°çš„ç§å­æ•°æ®æˆ–è¡¨ç»“æ„å˜æ›´

# 7. æµ‹è¯•è¿è¡Œ
dotnet run
```

### 7.3 å‰ç«¯å‡çº§

```bash
# 1. æ›´æ–°ä¾èµ–
pnpm update

# 2. æ£€æŸ¥ç ´åæ€§å˜æ›´
pnpm outdated

# 3. é‡æ–°æ„å»º
pnpm build
```

---

## 8. å­¦ä¹ èµ„æºä¸ç¤¾åŒºæ”¯æŒ

### 8.1 å®˜æ–¹èµ„æº

**ä»£ç ä»“åº“**ï¼š
- Giteeï¼šhttps://gitee.com/zuohuaijun/Admin.NET
- GitHubï¼šhttps://github.com/zuohuaijun/Admin.NET
- GitCodeï¼šhttps://gitcode.com/zuohuaijun/Admin.NET

**æ–‡æ¡£èµ„æ–™**ï¼š
- å®˜æ–¹æ–‡æ¡£ï¼šhttps://adminnet.top/
- åœ¨çº¿æ¼”ç¤ºï¼šhttps://demo.adminnet.top

### 8.2 ç›¸å…³æŠ€æœ¯æ–‡æ¡£

**åç«¯æŠ€æœ¯**ï¼š
- Furionæ–‡æ¡£ï¼šhttps://dotnetchina.gitee.io/furion
- SqlSugaræ–‡æ¡£ï¼šhttps://www.donet5.com/Home/Doc
- .NETæ–‡æ¡£ï¼šhttps://docs.microsoft.com/dotnet

**å‰ç«¯æŠ€æœ¯**ï¼š
- Vue3æ–‡æ¡£ï¼šhttps://cn.vuejs.org/
- Element Plusï¼šhttps://element-plus.org/zh-CN/
- Viteæ–‡æ¡£ï¼šhttps://cn.vitejs.dev/

### 8.3 ç¤¾åŒºäº¤æµ

**QQäº¤æµç¾¤**ï¼š
- äº¤æµç¾¤1ï¼š87333204
- äº¤æµç¾¤2ï¼š252381476

**é—®é¢˜åé¦ˆ**ï¼š
- åœ¨Gitee/GitHubæäº¤Issue
- è¯¦ç»†æè¿°é—®é¢˜ç°è±¡
- æä¾›å¤ç°æ­¥éª¤
- é™„ä¸Šé”™è¯¯æ—¥å¿—

### 8.4 å­¦ä¹ å»ºè®®

1. **ç³»ç»Ÿå­¦ä¹ **ï¼šæŒ‰ç…§æœ¬æ•™ç¨‹ç« èŠ‚é¡ºåºå­¦ä¹ 
2. **åŠ¨æ‰‹å®è·µ**ï¼šè¾¹å­¦è¾¹åšï¼Œåˆ›å»ºè‡ªå·±çš„æ¨¡å—
3. **é˜…è¯»æºç **ï¼šæ·±å…¥ç†è§£æ¡†æ¶å®ç°åŸç†
4. **å‚ä¸ç¤¾åŒº**ï¼šå›ç­”é—®é¢˜ã€æäº¤PR
5. **æŒç»­æ›´æ–°**ï¼šå…³æ³¨æ¡†æ¶ç‰ˆæœ¬æ›´æ–°

---

## æ€»ç»“

æœ¬ç« æ¶µç›–äº†Admin.NETå¼€å‘å’Œè¿ç»´çš„æœ€ä½³å®è·µï¼š

1. **ç¼–ç è§„èŒƒ**ï¼šå‘½åè§„èŒƒã€ä»£ç ç»“æ„ã€Gitæäº¤è§„èŒƒ
2. **æ€§èƒ½ä¼˜åŒ–**ï¼šæ•°æ®åº“æŸ¥è¯¢ã€ç¼“å­˜ä½¿ç”¨ã€å¼‚æ­¥ç¼–ç¨‹
3. **å®‰å…¨åŠ å›º**ï¼šè®¤è¯æˆæƒã€SQLæ³¨å…¥ã€XSSé˜²æŠ¤
4. **æ•°æ®åº“ä¼˜åŒ–**ï¼šç´¢å¼•ã€åˆ†è¡¨ã€è¯»å†™åˆ†ç¦»
5. **å¸¸è§é—®é¢˜**ï¼šé¡¹ç›®è¿è¡Œã€å‰ç«¯ã€éƒ¨ç½²é—®é¢˜è§£ç­”
6. **æ•…éšœæ’æŸ¥**ï¼šæ—¥å¿—åˆ†æã€æ€§èƒ½è¯Šæ–­ã€æ•°æ®åº“è¯Šæ–­
7. **ç‰ˆæœ¬å‡çº§**ï¼šå‡çº§å‡†å¤‡ã€æ­¥éª¤ã€æ³¨æ„äº‹é¡¹
8. **å­¦ä¹ èµ„æº**ï¼šå®˜æ–¹èµ„æºã€æŠ€æœ¯æ–‡æ¡£ã€ç¤¾åŒºæ”¯æŒ

é€šè¿‡æœ¬æ•™ç¨‹çš„å­¦ä¹ ï¼Œä½ åº”è¯¥å·²ç»æŒæ¡äº†Admin.NETçš„æ ¸å¿ƒæ¦‚å¿µå’Œå¼€å‘æŠ€èƒ½ã€‚å¸Œæœ›è¿™äº›å†…å®¹èƒ½å¤Ÿå¸®åŠ©ä½ åœ¨å®é™…é¡¹ç›®ä¸­æ›´å¥½åœ°ä½¿ç”¨Admin.NETæ¡†æ¶ã€‚

ç¥ä½ å¼€å‘é¡ºåˆ©ï¼ğŸ‰
